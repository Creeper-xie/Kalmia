# 基本

### 摘要密码

使用摘要存储密码，即时计算摘要比对来登录

### 减少尝试

每个连接尝试登录的频率会被限制，指定时间内的登录尝试一定会失败且不会给出原因

以此防止密码暴力破解

### 传输加密

至少使用 256 位随机密钥与 32 位随机初始化向量进行至少 1 次 AES 加密

### 握手

至少使用 521 位预共享椭圆曲线密钥进行 AES 密钥与初始化向量交换，禁用 RSA

AES 数据交换后使用 testKey、testSha校验加密数据

以此防止中间人窃取攻击

### 数据包校验

使用摘要确保数据包完整性和未被随机修改

### SQL注入

不使用SQL避免了SQL注入（不是）

# 额外

### 重放攻击

在数据包中添加时间戳和随机唯一标识，使用有效时间和已记录标识拒绝重放攻击

这意味着过高的延迟将会无法使用山月桂

# 尚未解决

中间人阻断、TCP Reset等阻断攻击

# 实现

### 避免完全劫持

MITM完全劫持（窃取）对山月桂是无效的，因为山月桂使用了一个预共享的公开公钥

客户端会准备好公钥域，然后请求服务端使用这个域下的私钥（域一般是 ```Kalmia/Main```）

由于中间人不知道 ```Kalmia/Main``` 下的私钥是什么
\
则无法解密客户端发给服务端的密文，AES密钥得到安全传输

若中间人使用其他私钥，则由于与公钥不匹配而无法解密

若是和客户端请求其他键下的密钥，需要客户端手动输入公钥
\
客户端可以在其他山月桂服务器的开放平台下获取公钥，而不会使用中间人的公钥

因此MITM（窃取）问题得到完全解决，但MITM（阻断）问题依旧存在