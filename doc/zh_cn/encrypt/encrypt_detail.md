# Server Hello
由于使用RSA公钥进行AES密钥传输，在客户端加密自己的密钥发给服务端时，中间人并不知道客户端真正的密钥
\
因为RSA公钥不能用自己来解密出原始内容

\
若中间人不使用自己的密钥拦截客户端的密钥，则MITM无效
\
服务端和客户端的交流会使用客户端的密钥，由于本身就不知道客户端密钥，则无法再攻击这一次连接

\
若中间人使用自己的密钥拦截客户端的密钥，服务端会给客户端将原始密钥发回（加密后）
\
而由于中间人不知道客户端的原始密钥，解密出来得到的是中间人自己的密钥
\
客户端必然收到错误的密钥，这时客户端就知道连接是不安全的

## 对称性

客户端的加密和服务端应该是使用同样的密钥

\
则受到中间人攻击时，中间人由于不知道客户端的密钥
\
无法将正确密文发给客户端，直接原样发送也无法被客户端解密

## 完全劫持

MITM完全劫持对山月桂是无效的，因为山月桂使用了一个预共享的RSA密钥

客户端会准备好公钥键，然后请求服务端使用这个键下的私钥（键一般是 ```Kalmia/Main```）

由于中间人不知道 ```Kalmia/Main``` 下的私钥是什么
\
则无法解密客户端发给服务端的密文，AES密钥得到安全传输

若中间人使用其他密钥，则由于公钥密钥不匹配而无法解密

若是和客户端请求其他键下的密钥，需要客户端手动输入公钥
\
客户端可以在其他山月桂服务器的开放平台下获取公钥，而不会使用中间人的公钥

因此MITM问题得到完全解决