# Server Hello
由于使用RSA公钥进行AES密钥传输，在客户端加密自己的密钥发给服务端时，中间人并不知道客户端真正的密钥

因为RSA公钥不能用自己来解密出原始内容

\
若中间人不使用自己的密钥拦截客户端的密钥，则MITM无效

服务端和客户端的交流会使用客户端的密钥，由于本身就不知道客户端密钥，则无法再攻击这一次连接

\
若中间人使用自己的密钥拦截客户端的密钥，服务端会给客户端将原始密钥发回（加密后）

而由于中间人不知道客户端的原始密钥，解密出来得到的是中间人自己的密钥

客户端必然收到错误的密钥，这时客户端就知道连接是不安全的

## 对称性
客户端的加密和服务端应该是使用同样的密钥

\
则受到中间人攻击时，中间人由于不知道客户端的密钥

无法将正确密文发给客户端，直接原样发送也无法被客户端解密

\
中间人可以利用状态包无加密的漏洞让客户端正常解密数据

因此需要注意，漏洞修复就不再需要Server Hello验证了，但这一步骤会被保留

# 摆烂

如果中间人伪造一个服务端，代替真正的服务端和客户端握手\
再伪造一个客户端，代替真正的客户端和服务端握手

那么中间人只需要用自己的密钥解密客户端的信息\
再用服务端的密钥打包给服务端，即可保留甚至修改所有的原始数据

所以，预共享！